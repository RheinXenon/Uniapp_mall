# 购物车功能实现说明

## 功能概述
已成功实现购物车添加、保存和同步功能，使用本地存储和JSON文件进行数据管理。

## 实现的功能

### 1. 购物车数据管理 (`utils/cartManager.js`)
- ✅ 添加商品到购物车
- ✅ 从购物车移除商品  
- ✅ 更新商品数量
- ✅ 切换商品选中状态
- ✅ 全选/取消全选
- ✅ 购物车数据本地存储
- ✅ 购物车数据JSON文件读写
- ✅ 购物车商品总数计算
- ✅ 购物车总价计算

### 2. 商品详情页面 (`pages/product/detail.vue`)
- ✅ 点击"加入购物车"真实添加商品到购物车
- ✅ 显示购物车商品数量
- ✅ 页面显示时自动更新购物车数量

### 3. 购物车页面 (`pages/cart/cart.vue`) 
- ✅ 从本地数据加载购物车内容
- ✅ 页面显示时自动刷新数据
- ✅ 商品数量增减功能
- ✅ 商品删除功能
- ✅ 商品选中/取消选中
- ✅ 全选/取消全选功能
- ✅ 实时计算总价和商品数量

### 4. 应用配置 (`App.vue`)
- ✅ 全局注册购物车管理器
- ✅ 应用启动时初始化购物车功能

## 数据存储

### 本地存储
- 存储键: `shopping_cart_data`
- 使用 `uni.getStorageSync()` 和 `uni.setStorageSync()` 进行读写

### JSON文件存储
- 文件路径: `/static/data/cart.json`
- 包含商品数据和更新时间戳

## 数据结构

### 购物车商品对象
```javascript
{
  id: 1,                    // 商品ID
  name: "商品名称",           // 商品名称
  price: 7999,              // 商品价格
  quantity: 1,              // 商品数量
  selected: true,           // 是否选中
  image: "/path/to/image",  // 商品图片
  spec: "规格描述",          // 商品规格
  addTime: "ISO时间戳"       // 添加时间
}
```

## 使用方式

### 在页面中使用购物车管理器
```javascript
// 获取购物车管理器实例
const cartManager = getApp().globalData.cartManager

// 添加商品到购物车
const result = await cartManager.addToCart(product, quantity, spec)

// 获取购物车数据
const cartData = await cartManager.getCartData()

// 更新商品数量
const result = await cartManager.updateQuantity(productId, spec, quantity)
```

## 测试建议

1. **添加商品测试**
   - 在商品详情页点击"加入购物车"
   - 检查是否显示成功提示
   - 检查购物车图标数量是否更新

2. **购物车页面测试**
   - 切换到购物车标签页
   - 检查商品是否正确显示
   - 测试数量增减功能
   - 测试商品删除功能
   - 测试选中/取消选中功能

3. **数据持久化测试**
   - 添加商品后重启应用
   - 检查购物车数据是否保持
   - 测试跨页面数据同步

## 注意事项

1. **商品规格处理**: 目前使用商品的specs数组生成默认规格描述
2. **数据同步**: 所有购物车操作都会自动保存到本地存储
3. **错误处理**: 包含完整的错误处理和用户提示
4. **性能优化**: 使用异步操作，避免阻塞UI

## 后续优化建议

1. 添加购物车页面的批量删除功能
2. 实现商品规格选择功能
3. 添加购物车商品限购数量验证
4. 实现服务器端数据同步
5. 添加购物车商品过期处理
